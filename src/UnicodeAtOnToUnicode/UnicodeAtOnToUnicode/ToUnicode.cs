using System;
using System.Text;

namespace UnicodeAtOnToUnicode
{
    public class ToUnicode
    { /// <summary>
      /// 將原本是Unicode補完計畫中的外字字串轉換成Unicode編碼型式(&#XXXX)
      /// </summary>
      /// <param name="content">字串:將被轉換的內容</param>
      /// <returns>回傳:已轉換的內容</returns>
        public static String ConvertToUnicodeType(string content)
        {
            string returnString = "";
            for (int i = 0; i < content.Length; i++)
            {
                byte[] unicode = Encoding.Unicode.GetBytes(content);
                char[] unicode2 = Encoding.Unicode.GetChars(unicode);
                int codeIndex = unicode2[i];//找出位元組在UNICODE中的索引值
                //將位元組的編碼值重新給值
                if (codeIndex >= 63223 && codeIndex <= 63391)
                {
                    if (codeIndex >= 63223 && codeIndex <= 63305)
                    {
                        codeIndex -= 50870;
                    }
                    else if (codeIndex >= 63306 && codeIndex <= 63391)
                    {
                        codeIndex -= 50857;
                    }
                }
                else if (codeIndex == 63219)
                {
                    codeIndex = 12540;
                }
                returnString += CheckCode(unicode2[i], codeIndex);
            }

            return returnString;
        }



        /// <summary>
        /// 將原本是Unicode補完計畫中的外字字串轉換成Unicode
        /// </summary>
        /// <param name="content">字串:將被轉換的內容</param>
        /// <returns>回傳:已轉換的內容</returns>
        public static string ConvertToUnicode(string content)
        {
            string returnString = "";
            for (int i = 0; i < content.Length; i++)
            {
                byte[] unicode = Encoding.Unicode.GetBytes(content);
                char[] unicode2 = Encoding.Unicode.GetChars(unicode);
                int codeIndex = unicode2[i];//找出位元組在UNICODE中的索引值
                //將位元組的編碼值重新給值
                if (codeIndex >= 63223 && codeIndex <= 63391)
                {
                    if (codeIndex >= 63223 && codeIndex <= 63305)
                    {
                        codeIndex -= 50870;
                    }
                    else if (codeIndex >= 63306 && codeIndex <= 63391)
                    {
                        codeIndex -= 50857;
                    }
                }
                else if (codeIndex == 63219)
                {
                    codeIndex = 12540;
                }
                unicode2[i] = System.Convert.ToChar(codeIndex);
                returnString += System.Convert.ToString(System.Convert.ToChar(codeIndex));

            }
            return returnString;
        }





        private static string CheckCode(char uniCode2, int uniCode)
        {

            #region 宣告字碼表
            int[][] table = new int[256][];
            table[0] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 1, 0, 59374, 1983, 65535, 65535, 65535, 65535 };
            table[1] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[2] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11904, 512, 0, 0 };
            table[3] = new int[] { 32, 0, 0, 0, 0, 0, 0, 0, 0, 65534, 1019, 65534, 1019, 0, 0, 0 };
            table[4] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[5] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[6] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[7] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[8] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[9] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[10] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[11] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[12] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[13] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[14] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[15] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[16] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[17] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[18] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[19] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[20] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[21] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[22] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[23] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[24] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[25] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[26] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[27] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[28] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[29] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[30] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[31] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[32] = new int[] { 0, 13176, 244, 18476, 0, 0, 0, 0, 0, 0, 4096, 0, 0, 0, 0, 0 };
            table[33] = new int[] { 552, 0, 0, 0, 0, 0, 1023, 0, 0, 975, 0, 0, 0, 0, 0, 0 };
            table[34] = new int[] { 0, 50528, 20009, 48, 0, 4, 203, 0, 0, 544, 32, 32768, 0, 0, 0, 0 };
            table[35] = new int[] { 128, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[36] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[37] = new int[] { 4101, 4369, 4112, 4112, 0, 65535, 65535, 31, 65534, 56, 3, 12300, 51392, 0, 60, 0 };
            table[38] = new int[] { 608, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[39] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[40] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[41] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[42] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[43] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[44] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[45] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[46] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[47] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[48] = new int[] { 65295, 28727, 1022, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[49] = new int[] { 65504, 65535, 1023, 0, 0, 0, 0, 0, 0, 65532, 0, 0, 0, 0, 0, 0 };
            table[50] = new int[] { 0, 0, 65535, 65535, 15, 0, 0, 0, 65535, 65535, 65535, 1, 0, 0, 0, 0 };
            table[51] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 49152, 28672, 2, 0, 16400, 38, 0, 0 };
            table[52] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[53] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[54] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[55] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[56] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[57] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[58] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[59] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[60] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[61] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[62] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[63] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[64] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[65] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[66] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[67] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[68] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[69] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[70] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[71] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[72] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[73] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[74] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[75] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[76] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[77] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[78] = new int[] { 65419, 50035, 26688, 6927, 59820, 62284, 512, 49160, 31068, 51774, 31094, 1608, 12255, 63472, 826, 43263 };
            table[79] = new int[] { 61239, 9023, 45060, 64857, 62410, 65535, 56991, 65529, 44031, 32247, 49152, 36588, 61119, 65499, 53251, 17914 };
            table[80] = new int[] { 64225, 57342, 49135, 4267, 65515, 64682, 61247, 9469, 30893, 32630, 61452, 60927, 53238, 11514, 63481, 60267 };
            table[81] = new int[] { 8189, 38335, 26231, 49087, 15355, 65204, 31662, 4578, 42625, 16830, 5173, 29379, 32112, 29073, 3, 10091 };
            table[82] = new int[] { 22475, 28879, 18226, 3567, 32474, 64628, 65030, 48564, 16287, 35786, 32329, 22528, 8847, 60396, 35420, 56763 };
            table[83] = new int[] { 61280, 46823, 41999, 62099, 14267, 21662, 53323, 39855, 50196, 63444, 12464, 2580, 12040, 35024, 65406, 6447 };
            table[84] = new int[] { 65498, 64263, 32753, 31723, 50671, 16, 39423, 65023, 31191, 1383, 65511, 64971, 50175, 16448, 28663, 48526 };
            table[85] = new int[] { 57338, 1175, 62656, 23551, 60795, 53479, 1150, 63712, 65439, 46910, 32254, 34862, 65533, 48767, 33790, 63172 };
            table[86] = new int[] { 62295, 47357, 54912, 61309, 22375, 18312, 65405, 50143, 61695, 14249, 32224, 28924, 16239, 60570, 19635, 34433 };
            table[87] = new int[] { 16286, 56668, 63245, 18457, 65187, 7, 44886, 14591, 38925, 61368, 16445, 46944, 55502, 36917, 29375, 16383 };
            table[88] = new int[] { 32759, 31249, 63419, 44031, 65280, 28606, 43324, 65138, 53231, 61723, 56171, 64522, 50150, 61310, 39836, 62992 };
            table[89] = new int[] { 61512, 5876, 65205, 20866, 51121, 5563, 28295, 64479, 58431, 25549, 49663, 32382, 65003, 32095, 30587, 64766 };
            table[90] = new int[] { 38411, 56298, 25129, 21480, 14303, 65007, 14069, 48513, 56344, 64701, 53988, 65535, 16343, 65504, 32623, 45048 };
            table[91] = new int[] { 39854, 28377, 62971, 61717, 31145, 48635, 23100, 44463, 56250, 8108, 29180, 33657, 31991, 50015, 57343, 1383 };
            table[92] = new int[] { 65434, 33895, 5428, 57227, 63987, 13171, 63421, 24090, 48960, 41023, 65535, 491, 57280, 53213, 29952, 43987 };
            table[93] = new int[] { 63683, 61142, 17405, 47103, 24239, 16935, 39852, 63110, 10199, 63164, 63367, 13751, 43725, 57718, 18919, 58015 };
            table[94] = new int[] { 21596, 45042, 11071, 25048, 64571, 48056, 65487, 31613, 49045, 7392, 32253, 17407, 24566, 65534, 54255, 50382 };
            table[95] = new int[] { 36278, 44476, 25564, 4587, 57177, 9168, 48820, 62427, 8167, 56263, 65379, 64228, 45611, 25591, 60731, 44474 };
            table[96] = new int[] { 65025, 32511, 65527, 700, 13055, 61245, 65532, 32773, 30715, 48373, 269, 65527, 65531, 48954, 87, 57343 };
            table[97] = new int[] { 61307, 48509, 56200, 51412, 65523, 60796, 24046, 22271, 32269, 44127, 65430, 54655, 16366, 49472, 28665, 65511 };
            table[98] = new int[] { 30619, 36471, 28351, 58461, 28623, 24351, 57471, 65247, 55259, 510, 65280, 64379, 65492, 8159, 63488, 65535 };
            table[99] = new int[] { 64399, 123, 48896, 32604, 65535, 2035, 60320, 15847, 63423, 64471, 65471, 24579, 65533, 49133, 61371, 639 };
            table[100] = new int[] { 65088, 56829, 65023, 58105, 26635, 64287, 64483, 45053, 40868, 63469, 31357, 63503, 61118, 4053, 47965, 64927 };
            table[101] = new int[] { 62171, 15353, 65151, 60364, 34666, 29690, 38396, 40956, 4255, 64247, 56759, 48077, 63614, 60621, 62310, 15423 };
            table[102] = new int[] { 65533, 45119, 59895, 1662, 38574, 65030, 54646, 24535, 16337, 41971, 52999, 28599, 40913, 32580, 31577, 54237 };
            table[103] = new int[] { 44859, 43453, 32207, 65338, 64480, 63211, 46081, 65535, 31482, 47039, 49152, 4093, 65407, 65311, 65276, 38399 };
            table[104] = new int[] { 0, 46556, 61283, 16190, 64383, 27, 59392, 64502, 40687, 47327, 65439, 63, 31696, 62975, 57307, 16383 };
            table[105] = new int[] { 65008, 191, 33824, 48061, 57143, 65502, 65389, 4083, 24652, 24315, 65531, 64251, 65118, 537, 31220, 63966 };
            table[106] = new int[] { 42999, 60410, 491, 65332, 60371, 61299, 45015, 49216, 29371, 56575, 61823, 12248, 47340, 65035, 56739, 7947 };
            table[107] = new int[] { 36637, 18383, 45355, 65502, 32750, 55923, 9471, 52164, 63325, 52210, 60669, 46317, 49145, 19933, 39389, 64397 };
            table[108] = new int[] { 47999, 44923, 56827, 51545, 64591, 64181, 45027, 27999, 65535, 16253, 30720, 65499, 46847, 32511, 64431, 559 };
            table[109] = new int[] { 65435, 61383, 65445, 65535, 7, 50944, 63487, 65521, 32765, 447, 56320, 64956, 49141, 65535, 65407, 16127 };
            table[110] = new int[] { 41, 48640, 63999, 65407, 28411, 64894, 52223, 926, 58112, 64477, 52479, 63199, 65535, 4479, 63488, 64502 };
            table[111] = new int[] { 59375, 55100, 65263, 57327, 49163, 60863, 65247, 64973, 31733, 16637, 65535, 46943, 65503, 63792, 64479, 56471 };
            table[112] = new int[] { 65267, 49138, 36831, 57279, 6015, 60902, 3967, 13651, 17532, 34686, 64018, 17851, 60896, 30622, 32791, 49113 };
            table[113] = new int[] { 32341, 56969, 49519, 1095, 31454, 63325, 22527, 10501, 34551, 65173, 38835, 62255, 53247, 40821, 29175, 64279 };
            table[114] = new int[] { 13550, 60953, 14284, 61281, 40918, 61260, 54927, 64477, 31603, 28143, 55294, 42033, 24191, 38871, 3931, 65496 };
            table[115] = new int[] { 40323, 31694, 8940, 56575, 30269, 61319, 57319, 65005, 20479, 41212, 15223, 56316, 15853, 32732, 28585, 62832 };
            table[116] = new int[] { 16379, 11328, 65407, 33919, 60503, 57015, 59036, 61999, 4075, 54709, 45035, 60903, 35887, 65520, 21375, 59632 };
            table[117] = new int[] { 47517, 46591, 65382, 59279, 55681, 48656, 40060, 58305, 40145, 10035, 3260, 65389, 64695, 61367, 41183, 65535 };
            table[118] = new int[] { 48907, 65147, 41983, 13631, 5068, 38861, 30263, 64295, 53206, 32364, 60496, 60721, 26492, 64540, 63226, 24511 };
            table[119] = new int[] { 4026, 44591, 41901, 32766, 64752, 56948, 65519, 61952, 64447, 65186, 15791, 48383, 63124, 24505, 62381, 16271 };
            table[120] = new int[] { 62060, 40991, 65519, 447, 30504, 28677, 65333, 55811, 54011, 51194, 16319, 23581, 65338, 60467, 47023, 65180 };
            table[121] = new int[] { 21046, 31391, 49146, 59170, 40951, 64767, 12219, 46621, 60678, 7677, 32215, 61407, 60195, 61798, 32473, 3520 };
            table[122] = new int[] { 15677, 57279, 51525, 47747, 32209, 40400, 31623, 53107, 40947, 50165, 57101, 50686, 3251, 33538, 59513, 44736 };
            table[123] = new int[] { 51059, 28431, 64893, 2367, 65521, 343, 25339, 511, 64948, 15347, 45075, 17330, 24275, 65328, 4095, 60319 };
            table[124] = new int[] { 65263, 61955, 16367, 64393, 14249, 40601, 57081, 42796, 14131, 49654, 33198, 65086, 23840, 62199, 54661, 27095 };
            table[125] = new int[] { 65535, 65535, 56071, 65391, 50431, 55679, 61390, 48655, 61819, 61534, 63183, 65463, 24311, 61316, 55243, 3807 };
            table[126] = new int[] { 65288, 64767, 60991, 65535, 5119, 55295, 44815, 32765, 48583, 8186, 0, 0, 0, 0, 0, 0 };
            table[127] = new int[] { 0, 0, 0, 59200, 48440, 63795, 32747, 65261, 32744, 31862, 46071, 65519, 65199, 55479, 65391, 64447 };
            table[128] = new int[] { 63739, 56311, 5970, 58105, 34248, 30023, 37008, 58351, 40692, 16237, 60974, 1334, 63420, 32755, 41083, 32575 };
            table[129] = new int[] { 1383, 60256, 47806, 26113, 64728, 22591, 51959, 34783, 49101, 65440, 23501, 65215, 46845, 61351, 30703, 57244 };
            table[130] = new int[] { 16311, 63607, 40231, 47100, 51893, 57327, 64346, 61878, 60473, 61215, 64447, 32763, 13, 56062, 48635, 20095 };
            table[131] = new int[] { 13311, 23232, 49141, 40958, 65471, 95, 0, 65016, 65482, 28669, 53245, 40961, 57343, 64498, 57279, 65407 };
            table[132] = new int[] { 65242, 2063, 47624, 49151, 31485, 61143, 64491, 26617, 57412, 65427, 57239, 40791, 65271, 2271, 57216, 65247 };
            table[133] = new int[] { 65477, 63486, 65531, 26627, 26619, 27642, 32767, 24546, 65535, 65395, 34783, 59387, 60413, 63399, 49022, 61383 };
            table[134] = new int[] { 7923, 57218, 30463, 57214, 31177, 55933, 61374, 7835, 31968, 30715, 34750, 65531, 7167, 65499, 16220, 20448 };
            table[135] = new int[] { 32767, 24334, 30719, 56767, 61519, 65535, 65535, 4088, 41918, 64991, 64540, 65533, 8061, 64414, 48639, 57052 };
            table[136] = new int[] { 16239, 47867, 57215, 64495, 32027, 12012, 44942, 62199, 31503, 53230, 7574, 30662, 65031, 65525, 55682, 32735 };
            table[137] = new int[] { 24294, 51199, 65262, 31215, 39510, 65487, 65119, 56926, 35182, 63976, 62558, 59076, 1, 48764, 15231, 56799 };
            table[138] = new int[] { 54685, 59887, 13484, 56915, 62835, 19447, 31567, 40703, 47358, 18286, 3579, 65349, 44029, 64510, 59863, 56831 };
            table[139] = new int[] { 60919, 32767, 56829, 32491, 53223, 47103, 48617, 61329, 23925, 55164, 0, 0, 0, 0, 0, 0 };
            table[140] = new int[] { 0, 0, 0, 64128, 65518, 46321, 49014, 12271, 46711, 30655, 40895, 65533, 38335, 63150, 30207, 32571 };
            table[141] = new int[] { 42997, 2809, 0, 0, 0, 0, 64464, 11229, 63027, 39551, 64939, 55036, 63974, 49131, 57311, 62495 };
            table[142] = new int[] { 42749, 65535, 19199, 62331, 32695, 65273, 46847, 7516, 32758, 58879, 8059, 9220, 48645, 63902, 56291, 57330 };
            table[143] = new int[] { 28655, 65023, 54905, 52220, 60413, 61439, 31, 0, 0, 38912, 57672, 32791, 27252, 254, 28031, 65009 };
            table[144] = new int[] { 47231, 65267, 57375, 61814, 61078, 31551, 60301, 65533, 44543, 52147, 34031, 57727, 19882, 49136, 48959, 65087 };
            table[145] = new int[] { 60415, 65495, 65503, 53119, 65531, 34285, 55103, 1980, 44799, 65039, 64943, 30399, 64239, 14267, 32732, 41914 };
            table[146] = new int[] { 46847, 22263, 24824, 59359, 65377, 19679, 45307, 65349, 32237, 16378, 8191, 6908, 65535, 58287, 51155, 57219 };
            table[147] = new int[] { 64343, 61309, 61439, 4984, 65216, 24567, 13499, 24291, 63245, 61430, 55294, 191, 62877, 63479, 20958, 65504 };
            table[148] = new int[] { 65225, 895, 24321, 49135, 40945, 24743, 61213, 61951, 15, 0, 0, 0, 0, 0, 0, 0 };
            table[149] = new int[] { 0, 0, 0, 0, 0, 0, 0, 15488, 64333, 55583, 31546, 65251, 16361, 56447, 63, 0 };
            table[150] = new int[] { 0, 20480, 62751, 48647, 64541, 63771, 48158, 29183, 28665, 23486, 22422, 39707, 32767, 65532, 34606, 45031 };
            table[151] = new int[] { 60405, 62287, 57341, 59173, 3036, 23876, 22343, 64989, 60735, 30608, 32127, 35528, 64250, 62457, 8234, 61259 };
            table[152] = new int[] { 62975, 31183, 43987, 2981, 63354, 64399, 36541, 31, 0, 0, 62208, 64846, 6743, 34816, 44716, 30292 };
            table[153] = new int[] { 6061, 52735, 65458, 62511, 23466, 56319, 2, 0, 0, 29632, 63978, 11839, 64142, 48127, 30396, 65491 };
            table[154] = new int[] { 61182, 32370, 32445, 59383, 63359, 52989, 4085, 0, 0, 0, 43264, 56219, 42183, 37247, 63690, 32462 };
            table[155] = new int[] { 32122, 51175, 52157, 56494, 64894, 36726, 37331, 31987, 485, 19503, 60791, 41824, 2011, 24312, 7671, 8577 };
            table[156] = new int[] { 27616, 12444, 15162, 64222, 32595, 50165, 25037, 1978, 0, 0, 0, 0, 0, 0, 9952, 48894 };
            table[157] = new int[] { 1017, 60341, 58221, 59851, 39983, 49118, 40835, 43967, 8183, 65493, 47071, 57342, 64942, 65519, 64382, 61437 };
            table[158] = new int[] { 43775, 28351, 0, 0, 0, 0, 0, 46624, 32717, 48798, 25267, 22769, 61709, 64891, 59889, 48893 };
            table[159] = new int[] { 50883, 24429, 65341, 27135, 65487, 64500, 56571, 20471, 8192, 4407, 21, 0, 0, 0, 0, 0 };
            table[160] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[161] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[162] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[163] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[164] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[165] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[166] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[167] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[168] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[169] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[170] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[171] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[172] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[173] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[174] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[175] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[176] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[177] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[178] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[179] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[180] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[181] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[182] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[183] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[184] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[185] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[186] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[187] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[188] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[189] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[190] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[191] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[192] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[193] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[194] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[195] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[196] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[197] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[198] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[199] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[200] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[201] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[202] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[203] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[204] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[205] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[206] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[207] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[208] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[209] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[210] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[211] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[212] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[213] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[214] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[215] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[216] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[217] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[218] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[219] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[220] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[221] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[222] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[223] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[224] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[225] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[226] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[227] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[228] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[229] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[230] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[231] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[232] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[233] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[234] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[235] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[236] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[237] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[238] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[239] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[240] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[241] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[242] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[243] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[244] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[245] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[246] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[247] = new int[] { 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535, 65535 };
            table[248] = new int[] { 65535, 65535, 65535, 65535, 511, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 256 };
            table[249] = new int[] { 65535, 65535, 61439, 65535, 65535, 65535, 65535, 65023, 65535, 65503, 65535, 65535, 65535, 65535, 65407, 65533 };
            table[250] = new int[] { 16383, 32485, 15460, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[251] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[252] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[253] = new int[] { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[254] = new int[] { 0, 0, 0, 65531, 65055, 65271, 3967, 0, 0, 0, 0, 0, 0, 0, 0, 0 };
            table[255] = new int[] { 65534, 65535, 65535, 65535, 65535, 32767, 16, 0, 0, 0, 0, 0, 0, 0, 43, 0 };
            #endregion

            string newstr = "";

            //重新給值後除以陣列後找出位於字碼表的位置
            decimal codeIndexNumber = uniCode / 256;
            decimal X = Math.Floor(codeIndexNumber);
            codeIndexNumber = uniCode / 16;
            decimal Y = Math.Floor(codeIndexNumber) % 16;
            decimal K = uniCode % 16;
            int tX = System.Convert.ToInt16(X);
            int tY = System.Convert.ToInt16(Y);
            int tK = System.Convert.ToInt16(K);
            int check = table[tX][tY];
            //找出字碼表的位置後判斷是否為UNICODE補完擴充字集
            bool checkEnd = (System.Convert.ToBoolean(check >> tK) & 1 == 1);
            if (checkEnd == true)
            {
                newstr += uniCode2;
            }
            //如果是補完字集就轉換成UNICODE編碼
            else if (checkEnd == false)
            {
                newstr += "&#" + uniCode + ";";
            }


            return newstr;
        }
    }
}
